\hypertarget{kdtree__spherical_8c}{
\subsection{lib/kdtree\_\-spherical.c File Reference}
\label{kdtree__spherical_8c}\index{lib/kdtree\_\-spherical.c@{lib/kdtree\_\-spherical.c}}
}
Routines specific to the 2-dimensional spherical kd-tree. 

\subsubsection*{Functions}
\begin{CompactItemize}
\item 
float \hyperlink{kdtree__spherical_8c_7d710e611189fff7d0bab69a805a1be6}{kd\_\-sph\_\-xtd} (float $\ast$p1, float $\ast$p2, float $\ast$p3)
\begin{CompactList}\small\item\em Compute cross-track distance. \item\end{CompactList}\item 
struct \hyperlink{structkdNode}{kdNode} $\ast$ \hyperlink{kdtree__spherical_8c_b405951046c5fb4b748fa204cb4754ca}{kd\_\-sph\_\-buildTree} (struct kd\_\-point $\ast$points, unsigned long nPoints, void $\ast$($\ast$constr)(void $\ast$), void($\ast$destr)(void $\ast$), float $\ast$min, float $\ast$max, int max\_\-threads)
\begin{CompactList}\small\item\em build kd-tree structure \item\end{CompactList}\item 
struct \hyperlink{structpqueue}{pqueue} $\ast$ \hyperlink{kdtree__spherical_8c_0c97608c283a99ff3aa18d55ceabc064}{kd\_\-sph\_\-ortRangeSearch} (struct \hyperlink{structkdNode}{kdNode} $\ast$node, float $\ast$min, float $\ast$max)
\begin{CompactList}\small\item\em Perform orthogonal range search (get all points in a hyperrectangle). \item\end{CompactList}\item 
struct \hyperlink{structkdNode}{kdNode} $\ast$ \hyperlink{kdtree__spherical_8c_ffbfb5c1126325870161bde34d7343b5}{kd\_\-sph\_\-nearest} (struct \hyperlink{structkdNode}{kdNode} $\ast$node, float $\ast$p, float $\ast$max\_\-dist\_\-sq)
\begin{CompactList}\small\item\em Find the nearest neighbor of a point. \item\end{CompactList}\item 
struct \hyperlink{structpqueue}{pqueue} $\ast$ \hyperlink{kdtree__spherical_8c_3149e46c69685e4542785a457688c041}{kd\_\-sph\_\-qnearest} (struct \hyperlink{structkdNode}{kdNode} $\ast$node, float $\ast$p, float $\ast$max\_\-dist\_\-sq, unsigned int q)
\begin{CompactList}\small\item\em Return the q nearest-neighbors to a point. \item\end{CompactList}\item 
struct \hyperlink{structpqueue}{pqueue} $\ast$ \hyperlink{kdtree__spherical_8c_d364613d93fd76bb98202c11c0fdae1d}{kd\_\-sph\_\-range} (struct \hyperlink{structkdNode}{kdNode} $\ast$node, float $\ast$p, float $\ast$max\_\-dist\_\-sq, int ordered)
\begin{CompactList}\small\item\em Perform a range search around a point. \item\end{CompactList}\end{CompactItemize}


\subsubsection{Detailed Description}
Routines specific to the 2-dimensional spherical kd-tree. 



\subsubsection{Function Documentation}
\hypertarget{kdtree__spherical_8c_b405951046c5fb4b748fa204cb4754ca}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-buildTree@{kd\_\-sph\_\-buildTree}}
\index{kd\_\-sph\_\-buildTree@{kd\_\-sph\_\-buildTree}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-buildTree]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf kdNode}$\ast$ kd\_\-sph\_\-buildTree (struct kd\_\-point $\ast$ {\em points}, \/  unsigned long {\em nPoints}, \/  void $\ast$($\ast$)(void $\ast$) {\em constr}, \/  void($\ast$)(void $\ast$) {\em destr}, \/  float $\ast$ {\em min}, \/  float $\ast$ {\em max}, \/  int {\em max\_\-threads})\hspace{0.3cm}{\tt  \mbox{[}read\mbox{]}}}\hfill}
\label{kdtree__spherical_8c_b405951046c5fb4b748fa204cb4754ca}


build kd-tree structure 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em points}]an array of kd\_\-points (struct with position vector and data container).\item[{\em nPoints}]the length of the points array.\item[{\em constr}]a pointer to a void $\ast$constructor() function to include data container in tree; optional, can be NULL\item[{\em destr}]a pointer to a void destructor() function to free() data container in the tree; optional, can be NULL, but should be given if the constr argument is non-NULL.\item[{\em min}]a vector with the minimum positions of the corners of the hyperrectangle containing the data.\item[{\em max}]a vector with the maximum positions of the corners of the hyperrectangle containing the data.\item[{\em max\_\-threads}]the maximal number of threads spawned for construction of the tree. The threads will be unbalanced if this is not a power of 2.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]root node of the tree \end{Desc}
\hypertarget{kdtree__spherical_8c_ffbfb5c1126325870161bde34d7343b5}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-nearest@{kd\_\-sph\_\-nearest}}
\index{kd\_\-sph\_\-nearest@{kd\_\-sph\_\-nearest}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-nearest]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf kdNode}$\ast$ kd\_\-sph\_\-nearest (struct {\bf kdNode} $\ast$ {\em node}, \/  float $\ast$ {\em p}, \/  float $\ast$ {\em max\_\-dist\_\-sq})\hspace{0.3cm}{\tt  \mbox{[}read\mbox{]}}}\hfill}
\label{kdtree__spherical_8c_ffbfb5c1126325870161bde34d7343b5}


Find the nearest neighbor of a point. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em node}]the root node of the tree to be searched.\item[{\em p}]a vector to the point whose nearest neighbor is sought.\item[{\em max\_\-dist\_\-sq}]the square of the maximum distance to the nearest neighbor.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]A pointer to node containing the nearest neighbor. max\_\-dist\_\-sq is set to the square of the distance to the nearest neigbor. \end{Desc}
\hypertarget{kdtree__spherical_8c_0c97608c283a99ff3aa18d55ceabc064}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-ortRangeSearch@{kd\_\-sph\_\-ortRangeSearch}}
\index{kd\_\-sph\_\-ortRangeSearch@{kd\_\-sph\_\-ortRangeSearch}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-ortRangeSearch]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pqueue}$\ast$ kd\_\-sph\_\-ortRangeSearch (struct {\bf kdNode} $\ast$ {\em node}, \/  float $\ast$ {\em min}, \/  float $\ast$ {\em max})\hspace{0.3cm}{\tt  \mbox{[}read\mbox{]}}}\hfill}
\label{kdtree__spherical_8c_0c97608c283a99ff3aa18d55ceabc064}


Perform orthogonal range search (get all points in a hyperrectangle). 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em node}]the root node of tree to be searched.\item[{\em min}]a vector with the minimum positions of the corners of the hyperrectangle containing the data.\item[{\em max}]a vector with the maximum positions of the corners of the hyperrectangle containing the data.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]Pointer to a priority queue, NULL in case of problems.\end{Desc}
Rectangle must not cross the meridian! \hypertarget{kdtree__spherical_8c_3149e46c69685e4542785a457688c041}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-qnearest@{kd\_\-sph\_\-qnearest}}
\index{kd\_\-sph\_\-qnearest@{kd\_\-sph\_\-qnearest}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-qnearest]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pqueue}$\ast$ kd\_\-sph\_\-qnearest (struct {\bf kdNode} $\ast$ {\em node}, \/  float $\ast$ {\em p}, \/  float $\ast$ {\em max\_\-dist\_\-sq}, \/  unsigned int {\em q})\hspace{0.3cm}{\tt  \mbox{[}read\mbox{]}}}\hfill}
\label{kdtree__spherical_8c_3149e46c69685e4542785a457688c041}


Return the q nearest-neighbors to a point. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em node}]the root node of the tree to be searched.\item[{\em p}]a vector to the point whose nearest neighbors are sought.\item[{\em max\_\-dist\_\-sq}]the square of the maximum distance to the nearest neighbors.\item[{\em q}]the maximum number of points to be retured.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]A pointer to a priority queue of the points found, or NULL in case of problems. \end{Desc}
\hypertarget{kdtree__spherical_8c_d364613d93fd76bb98202c11c0fdae1d}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-range@{kd\_\-sph\_\-range}}
\index{kd\_\-sph\_\-range@{kd\_\-sph\_\-range}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-range]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pqueue}$\ast$ kd\_\-sph\_\-range (struct {\bf kdNode} $\ast$ {\em node}, \/  float $\ast$ {\em p}, \/  float $\ast$ {\em max\_\-dist\_\-sq}, \/  int {\em ordered})\hspace{0.3cm}{\tt  \mbox{[}read\mbox{]}}}\hfill}
\label{kdtree__spherical_8c_d364613d93fd76bb98202c11c0fdae1d}


Perform a range search around a point. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em node}]the root node of the tree to be searched.\item[{\em p}]the location of the point around which the search is carried out .\item[{\em max\_\-dist\_\-sq}]the square of the radius of the hypersphere.\item[{\em ordered}]determines whether the result list should be ordered in increasing distance (KD\_\-ORDERED) or unordered (KD\_\-UNORDERED).\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]A pointer to a priority queue containing the points found, NULL in case of problems. \end{Desc}
\hypertarget{kdtree__spherical_8c_7d710e611189fff7d0bab69a805a1be6}{
\index{kdtree\_\-spherical.c@{kdtree\_\-spherical.c}!kd\_\-sph\_\-xtd@{kd\_\-sph\_\-xtd}}
\index{kd\_\-sph\_\-xtd@{kd\_\-sph\_\-xtd}!kdtree_spherical.c@{kdtree\_\-spherical.c}}
\paragraph[kd\_\-sph\_\-xtd]{\setlength{\rightskip}{0pt plus 5cm}float kd\_\-sph\_\-xtd (float $\ast$ {\em p1}, \/  float $\ast$ {\em p2}, \/  float $\ast$ {\em p3})}\hfill}
\label{kdtree__spherical_8c_7d710e611189fff7d0bab69a805a1be6}


Compute cross-track distance. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p1}]a point\item[{\em p2}]a second point defining a great circle from p1\item[{\em p3}]a third point whose distance from the great circle we compute\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]distance of p3 from the great circle connecting p1 and p2. \end{Desc}
